<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üêÖ Bagh-Chal: Tiger and Goats üêê</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        .title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
        }

        .status-panel {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .game-board {
            background: #34495e;
            border: 3px solid #ecf0f1;
            border-radius: 10px;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .controls {
            margin-top: 20px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .btn-restart { background: #3498db; color: white; }
        .btn-rules { background: #2ecc71; color: white; }
        .btn-quit { background: #e74c3c; color: white; }

        .instructions {
            background: rgba(243, 156, 18, 0.2);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            text-align: center;
            max-width: 600px;
            line-height: 1.4;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: #2c3e50;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 80%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
        }
        .close:hover { color: #fff; }

        .rules-content {
            line-height: 1.6;
            font-size: 14px;
        }

        .rules-content h3 {
            color: #3498db;
            margin-top: 20px;
        }
    </style>
</head>
<body>
<div class="title">üêÖ Bagh-Chal: Tiger and Goats üêê</div>

<div class="status-panel">
    <div id="status">Loading game...</div>
</div>
<canvas id="gameCanvas" class="game-board" width="500" height="500"></canvas>

<div class="controls">
    <button class="btn btn-restart" onclick="resetGame()">üîÑ Restart Game</button>
    <button class="btn btn-rules" onclick="showRules()">üìñ Rules</button>
    <button class="btn btn-quit" onclick="window.close()">‚ùå Quit</button>
</div>

<div class="instructions" id="instructions">
    Click to start playing!
</div>

<!-- Rules Modal -->
<div id="rulesModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeRules()">&times;</span>
        <div class="rules-content">
            <h2>üêÖ BAGH-CHAL RULES üêê</h2>

            <h3>OBJECTIVE:</h3>
            <p>‚Ä¢ <strong>Tigers:</strong> Capture 5 goats to win<br>
                ‚Ä¢ <strong>Goats:</strong> Block all tigers so they cannot move</p>

            <h3>SETUP:</h3>
            <p>‚Ä¢ 4 tigers start at the corners<br>
                ‚Ä¢ 20 goats to be placed during the game</p>

            <h3>GAMEPLAY:</h3>
            <p><strong>1. PLACEMENT PHASE:</strong><br>
                ‚Ä¢ Goats are placed one by one on empty intersections<br>
                ‚Ä¢ After each goat placement, tigers can move</p>

            <p><strong>2. MOVEMENT PHASE</strong> (after all 20 goats are placed):<br>
                ‚Ä¢ Both tigers and goats can move to adjacent empty positions<br>
                ‚Ä¢ Tigers can also jump over goats to capture them<br>
                ‚Ä¢ Only one piece can be moved per turn</p>

            <h3>MOVEMENT RULES:</h3>
            <p>‚Ä¢ All pieces move along the lines to adjacent intersections<br>
                ‚Ä¢ Tigers can jump over adjacent goats to capture them<br>
                ‚Ä¢ Captured goats are removed from the board<br>
                ‚Ä¢ Goats cannot jump or capture</p>

            <h3>WIN CONDITIONS:</h3>
            <p>‚Ä¢ <strong>Tigers win</strong> by capturing 5 goats<br>
                ‚Ä¢ <strong>Goats win</strong> by blocking all tigers from moving</p>
        </div>
    </div>
</div>
<script>
    // Game constants
    const BOARD_SIZE = 5;
    const CANVAS_SIZE = 500;
    const CELL_SIZE = CANVAS_SIZE / (BOARD_SIZE + 1);
    const OFFSET = CELL_SIZE;

    // Game states
    const PLACEMENT_PHASE = 0;
    const MOVEMENT_PHASE = 1;

    // Piece types
    const EMPTY = 0;
    const TIGER = 1;
    const GOAT = 2;

    // Players
    const TIGER_PLAYER = 0;
    const GOAT_PLAYER = 1;

    // Game variables
    let currentPhase = PLACEMENT_PHASE;
    let currentPlayer = GOAT_PLAYER;
    let board = [];
    let goatsPlaced = 0;
    let goatsCaptured = 0;
    let selectedRow = -1;
    let selectedCol = -1;
    let pieceSelected = false;
    let gameOver = false;
    let winner = null;
    let connections = {};

    // Canvas setup
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    // Initialize game
    function initGame() {
        setupConnections();
        resetGame();
        canvas.addEventListener('click', onCanvasClick);
    }

    function setupConnections() {
        connections = {};
        for (let i = 0; i < BOARD_SIZE; i++) {
            for (let j = 0; j < BOARD_SIZE; j++) {
                const neighbors = [];
                const directions = [[-1, -1], [-1, 0], [-1, 1], [0, -1], [0, 1], [1, -1], [1, 0], [1, 1]];

                for (const [di, dj] of directions) {
                    const ni = i + di;
                    const nj = j + dj;
                    if (ni >= 0 && ni < BOARD_SIZE && nj >= 0 && nj < BOARD_SIZE) {
                        neighbors.push([ni, nj]);
                    }
                }
                connections[`${i},${j}`] = neighbors;
            }
        }
    }
    function resetGame() {
        currentPhase = PLACEMENT_PHASE;
        currentPlayer = GOAT_PLAYER;
        board = Array(BOARD_SIZE).fill().map(() => Array(BOARD_SIZE).fill(EMPTY));
        goatsPlaced = 0;
        goatsCaptured = 0;
        selectedRow = -1;
        selectedCol = -1;
        pieceSelected = false;
        gameOver = false;
        winner = null;

        // Place initial tigers at corners
        board[0][0] = TIGER;
        board[0][4] = TIGER;
        board[4][0] = TIGER;
        board[4][4] = TIGER;

        drawBoard();
        updateStatus();
    }

    function getCanvasCoords(row, col) {
        const x = OFFSET + col * CELL_SIZE;
        const y = OFFSET + row * CELL_SIZE;
        return [x, y];
    }

    function getBoardCoords(canvasX, canvasY) {
        const col = Math.round((canvasX - OFFSET) / CELL_SIZE);
        const row = Math.round((canvasY - OFFSET) / CELL_SIZE);

        if (row >= 0 && row < BOARD_SIZE && col >= 0 && col < BOARD_SIZE) {
            return [row, col];
        }
        return [null, null];
    }
    function drawBoard() {
        ctx.clearRect(0, 0, CANVAS_SIZE, CANVAS_SIZE);

        // Draw grid lines
        ctx.strokeStyle = '#ecf0f1';
        ctx.lineWidth = 2;

        for (let i = 0; i < BOARD_SIZE; i++) {
            for (let j = 0; j < BOARD_SIZE; j++) {
                const [x, y] = getCanvasCoords(i, j);
                const neighbors = connections[`${i},${j}`];

                for (const [ni, nj] of neighbors) {
                    if (ni > i || (ni === i && nj > j)) { // Avoid duplicate lines
                        const [nx, ny] = getCanvasCoords(ni, nj);
                        ctx.beginPath();
                        ctx.moveTo(x, y);
                        ctx.lineTo(nx, ny);
                        ctx.stroke();
                    }
                }
            }
        }
        // Draw intersection points
        for (let i = 0; i < BOARD_SIZE; i++) {
            for (let j = 0; j < BOARD_SIZE; j++) {
                const [x, y] = getCanvasCoords(i, j);
                ctx.fillStyle = '#ecf0f1';
                ctx.beginPath();
                ctx.arc(x, y, 4, 0, 2 * Math.PI);
                ctx.fill();
                ctx.strokeStyle = '#bdc3c7';
                ctx.stroke();
            }
        }

        // Draw pieces
        drawPieces();
    }